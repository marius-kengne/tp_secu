NAT Question6

sudo iptables -t nat -A POSTROUTING -o enp0s3 -j MASQUERADE
sudo iptables -A FORWARD -i enp0s8 -o enp0s3 -j ACCEPT
sudo iptables -A FORWARD -i enp0s3 -o enp0s8 -m state --state ESTABLISHED,RELATED -j ACCEPT
sudo iptables -t nat -L -n -v
sudo iptables -L FORWARD -n -v
ping -c 3 8.8.8.8
curl -I https://www.google.com


question : 8


sudo iptables -P INPUT DROP
sudo iptables -P FORWARD DROP
sudo iptables -P OUTPUT ACCEPT

sudo iptables -A INPUT -i lo -j ACCEPT
sudo iptables -A INPUT -i lo -j ACCEPT
sudo iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
sudo iptables -A FORWARD -m state --state ESTABLISHED,RELATED -j ACCEPT

sudo iptables -A INPUT -i enp0s8 -p icmp -j ACCEPT



resultat

m2@vm2-VirtualBox:~/Desktop$ sudo iptables -L -n -v
Chain INPUT (policy DROP 161 packets, 12819 bytes)
 pkts bytes target     prot opt in     out     source               destination         
   34  4398 ACCEPT     all  --  lo     *       0.0.0.0/0            0.0.0.0/0           
    0     0 ACCEPT     all  --  lo     *       0.0.0.0/0            0.0.0.0/0           
   46 26942 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            state RELATED,ESTABLISHED
    0     0 ACCEPT     icmp --  enp0s8 *       0.0.0.0/0            0.0.0.0/0           

Chain FORWARD (policy DROP 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         
 1439  111K ACCEPT     all  --  enp0s8 enp0s3  0.0.0.0/0            0.0.0.0/0           
 1198 7439K ACCEPT     all  --  enp0s3 enp0s8  0.0.0.0/0            0.0.0.0/0            state RELATED,ESTABLISHED
    0     0 ACCEPT     all  --  *      *       0.0.0.0/0            0.0.0.0/0            state RELATED,ESTABLISHED

Chain OUTPUT (policy ACCEPT 160 packets, 21648 bytes)
 pkts bytes target     prot opt in     out     source               destination         
vm2@vm2-VirtualBox:~/Desktop$ 



sudo iptables -L -n -v



sudo iptables -L INPUT --line-numbers
sudo iptables -L FORWARD --line-numbers

sudo iptables -D INPUT 2

vm2@vm2-VirtualBox:~/Desktop$ sudo iptables -L INPUT --line-numbers
Chain INPUT (policy DROP)
num  target     prot opt source               destination         
1    ACCEPT     all  --  anywhere             anywhere            
2    ACCEPT     all  --  anywhere             anywhere            
3    ACCEPT     all  --  anywhere             anywhere             state RELATED,ESTABLISHED
4    ACCEPT     icmp --  anywhere             anywhere            
vm2@vm2-VirtualBox:~/Desktop$ sudo iptables -L FORWARD --line-numbers
Chain FORWARD (policy DROP)
num  target     prot opt source               destination         
1    ACCEPT     all  --  anywhere             anywhere            
2    ACCEPT     all  --  anywhere             anywhere             state RELATED,ESTABLISHED
3    ACCEPT     all  --  anywhere             anywhere             state RELATED,ESTABLISHED
vm2@vm2-VirtualBox:~/Desktop$ 
